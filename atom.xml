<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>keep alive</title>
  
  
  <link href="http://keep-a.live/atom.xml" rel="self"/>
  
  <link href="http://keep-a.live/"/>
  <updated>2021-12-19T10:36:56.106Z</updated>
  <id>http://keep-a.live/</id>
  
  <author>
    <name>Li Wenjian</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Progress Report 7</title>
    <link href="http://keep-a.live/2021/12/19/Progress-Report-7/"/>
    <id>http://keep-a.live/2021/12/19/Progress-Report-7/</id>
    <published>2021-12-19T08:55:42.000Z</published>
    <updated>2021-12-19T10:36:56.106Z</updated>
    
    <content type="html"><![CDATA[<h2><span id="进展">进展</span></h2><blockquote><p>第十五周主要完成了对《视觉SLAM十四讲》中第九讲——后端1的学习。内容包括以EKF为代表的滤波器后端和非线性优化后端。</p></blockquote><p>这一章的理论非常多，并且书上讲的并不透彻。所以又去看了很多相关的资料，比如说<a href="https://www.youtube.com/channel/UCi1TC2fLRvgBQNe-T4dp8Eg">Cyrill Stachniss</a>发布的课程<a href="https://www.youtube.com/watch?v=LhWUwzYcZuw&amp;t=1221s">Photogrammetry II - 07c - Bundle Adjustment - Part 2 (2015/16) - YouTube</a>, <a href="https://www.youtube.com/watch?v=Tz3pg3d1TIo">SLAM Course - 12 - FastSLAM (2013/14; Cyrill Stachniss) - YouTube</a>等等。</p><h3><span id="后端概述">后端概述</span></h3><p>我的理解是，**前端只利用两帧图像进行定位与建图，而后端利用多张图像进行定位与建图。**这样做的好处有：</p><ul><li><strong>更完整的地图</strong>：比如说我们要建图的对象很复杂，仅仅使用两个图像可能依然会有一些遮挡的情况。必须从更对的位置对它进行观察才能获得其完整的样貌。</li><li><strong>更完整的路径</strong>：显然，如果想知道相机每一帧的位姿，也就是完整的路径，对每一帧都要进行估计。</li><li><strong>更高精度</strong>：单纯的使用前端会产生<strong>累计误差</strong>，意思是每使用一次视觉里程计，它都会有一定的不确定性，而一味的往前走这个不确定性就会累计。如果对每一步的估计都向右偏了1°，累积起来后果依然会很大。但是其实后面的观测对前面的观测依然有降低其不确定性的作用。所以说，考虑全局最优就是在消除累计误差。</li></ul><h3><span id="滤波器后端">滤波器后端</span></h3><p>滤波器是过去SLAM后端的主流方法（尤其是LiDAR里）。这种方法主要是从概率论的角度来看状态估计，在SLAM里要估计的状态就是相机的位姿$\boldsymbol x_1$到$\boldsymbol x_N$和路标的位置$\boldsymbol y_1$到$\boldsymbol y_M$了。</p><p>SLAM过程可以由运动方程和观测方程描述：<br>$$<br>\begin{array}{c}<br>\boldsymbol x_k = f(\boldsymbol x_{k-1}, \boldsymbol u_k)+\boldsymbol w_k \<br>\boldsymbol z_k = h(\boldsymbol y_j, \boldsymbol x_k)+\boldsymbol v_{k,j}<br>\end{array}<br>\ \ \ \ \ \ \ k = 1,…,N,j=1,…,M<br>$$<br>由于误差项的存在，这里的位姿和路标位置并不是确定的量，而是一些<strong>随机变量</strong>。</p><blockquote><p>举个例子，假如说运动方程中的$\boldsymbol u_k$是向正北走了1m，也就是机器人执行了向正北走1m的指令。但可能由于路面并不平，或者左边的轮子比右边的轮子大几毫米，或者就是单纯的多/少走了2cm，等等因素，真正的运动并不是真的向正北走1m。</p></blockquote><p>在这样的想法下，SLAM问题就变成了**“什么样的位姿和路标状态最有可能产生现在的观测？”<strong>的问题，也就是一种</strong>极大似然估计**。</p><p>记$k$时刻所有待估计的未知量为$\boldsymbol x_k\stackrel{\mathrm{def}}{=}{\boldsymbol x_k,\boldsymbol y_1,…,\boldsymbol y_M}$，运动和观测方程就变成了<br>$$<br>\left{<br>\begin{array}{c}<br>\boldsymbol x_k = f(\boldsymbol x_{k-1}, \boldsymbol u_k)+\boldsymbol w_k \<br>\boldsymbol z_k = h( \boldsymbol x_k)+\boldsymbol v_{k,j}<br>\end{array}<br>\ \ \ \ \ \ \ k = 1,…,N<br>\right.<br>$$<br>以下为贝叶斯滤波器的推导，我觉得书上并没有讲清楚，就补充在这里了</p><blockquote><p>我们希望通过$0$到$k$时刻得到的数据（运动的指令$\boldsymbol u_{1:k}$以及观测$\boldsymbol z_{1:k}$）求解$\boldsymbol x_k$的分布情况，在滤波器里也就是要找到下面式子的<strong>递推公式</strong>（可能是因为SLAM强调时序性）<br>$$<br>P(\boldsymbol x_k|\boldsymbol x_0, \boldsymbol u_{1:k}, \boldsymbol z_{1:k})<br>$$<br>按照贝叶斯公式，交换$\boldsymbol z_{k}$和$\boldsymbol x_{k}$可以得到<br>$$<br>P(\boldsymbol x_k|\boldsymbol x_0, \boldsymbol u_{1:k}, \boldsymbol z_{1:k})= \eta \underline {P(\boldsymbol z_{k}|\boldsymbol x_{k}, \boldsymbol u_{1:k}, \boldsymbol z_{1:k-1})}P(\boldsymbol x_k|\boldsymbol x_0, \boldsymbol u_{1:k}, \boldsymbol z_{1:k-1})<br>$$<br>其中$\eta$为归一化因子。第二项是观测$\boldsymbol z_{k}$的分布，这显然只与当前的位姿和路标有关，和之前的观测/运动都无关，所以也可以写成<br>$$<br>P(\boldsymbol x_k|\boldsymbol x_0, \boldsymbol u_{1:k}, \boldsymbol z_{1:k})= \eta P(\boldsymbol z_{k}|\boldsymbol x_{k})\underline {P(\boldsymbol x_k|\boldsymbol x_0, \boldsymbol u_{1:k}, \boldsymbol z_{1:k-1})}<br>$$<br>按照全概率公式以$\boldsymbol x_{k-1}$为条件展开可得<br>$$<br>P(\boldsymbol x_k|\boldsymbol x_0, \boldsymbol u_{1:k}, \boldsymbol z_{1:k-1})=\int_{\boldsymbol x_{k-1}}\underline{P(\boldsymbol x_k|\boldsymbol x_{k-1},\boldsymbol x_0, \boldsymbol u_{1:k}, \boldsymbol z_{1:k-1})}P(\boldsymbol x_{k-1}|\boldsymbol x_0, \boldsymbol u_{1:k}, \boldsymbol z_{1:k-1})dx_{k-1}<br>$$<br>假设马尔可夫性，$\boldsymbol x_k$只与$k-1$有关，与$k-1$之前都无关，就有<br>$$<br>P(\boldsymbol x_k|\boldsymbol x_0, \boldsymbol u_{1:k}, \boldsymbol z_{1:k})= \eta P(\boldsymbol z_{k}|\boldsymbol x_{k})\int <em>{\boldsymbol x</em>{k-1}}P(\boldsymbol x_k|\boldsymbol x_{k-1}, \boldsymbol u_{k})P(\boldsymbol x_{k-1}|\boldsymbol x_0, \underline{\boldsymbol u_{1:k}}, \boldsymbol z_{1:k-1})dx_{k-1}<br>$$<br>再假设$\boldsymbol x_{k-1}$与$\boldsymbol u_k$无关，就有</p><p>但其实也不一定无关，假如，世界只有前后间隔1m的两个可能的位置，$k$时刻的运动是<strong>向前1m</strong>，那么$k-1$的位置只可能是在<strong>后面</strong>而不是前面</p><p>$$<br>P(\boldsymbol x_k|\boldsymbol x_0, \boldsymbol u_{1:k}, \boldsymbol z_{1:k})= \eta P(\boldsymbol z_{k}|\boldsymbol x_{k})\int <em>{\boldsymbol x</em>{k-1}}P(\boldsymbol x_k|\boldsymbol x_{k-1}, \boldsymbol u_{k})\underline{P(\boldsymbol x_{k-1}|\boldsymbol x_0, \boldsymbol u_{1:k-1}, \boldsymbol z_{1:k-1})}dx_{k-1}<br>$$<br>而这里$P(\boldsymbol x_{k-1}|\boldsymbol x_0, \boldsymbol u_{1:k-1}, \boldsymbol z_{1:k-1})$就是$k-1$时刻的分布。这样我们就有了求解$\boldsymbol x_k$的分布情况的递归方法，以上也被称为<strong>贝叶斯滤波器</strong>。</p></blockquote><p>但实际上贝叶斯滤波器只是一个框架，并没有给出这个求积分的方法。具体的方法可以分为<strong>卡尔曼滤波器</strong>和<strong>粒子滤波器</strong>两大类。</p><ul><li>运动和观测方程均线性，噪声满足高斯分布→<strong>卡尔曼滤波器</strong></li><li>运动和观测方程非线性，但在某个点附近泰勒展开，噪声满足高斯分布→<strong>扩展卡尔曼滤波器</strong></li><li>噪声不满足高斯分布，用粒子模拟分布情况→<strong>粒子滤波器</strong></li></ul><p>但是在滤波器中，由于做了马尔可夫性的假设，依然没有考虑当前状态和很久以前状态的关系。并且还有EKF的线性化只能在很小的范围内成立，协方差矩阵会很大，没有异常检测机制等问题。尤其是在视觉SLAM中特征点很多且很容易存在误差。现在通常认为在同等计算量的条件下，非线性优化能取得更好的结果。</p><h3><span id="非线性优化后端">非线性优化后端</span></h3><p>使用图优化求解BA。BA即Bundle Adjustment，意思是调整（adjustment）相机位姿和空间点的位置，使得从特征点发出的几束光线（bundles of light rays）对准相机的光心。这一张中讨论的BA很类似于SfM问题，也就是并没有考虑图像的时序性和计算的实时性。这一部分内容将在下一章滑动窗口优化中讲解。</p><h4><span id="投影模型">投影模型</span></h4><p>投影模型如下<br>$$<br>\boldsymbol y=p=\begin{bmatrix}X\Y\Z\end{bmatrix}\xrightarrow[\text{相机坐标系}]{P’=Rp+t}<br>\begin{bmatrix}X’\Y’\Z’\end{bmatrix}\xrightarrow[\text{归一化坐标}]{}<br>\begin{bmatrix}X’/Z’\Y’/Z’\1\end{bmatrix}=\begin{bmatrix}u_c\v_c\1\end{bmatrix}\<br>$$<br>$$<br>\xrightarrow[\text{畸变模型}]{k_1,k_2}<br>\begin{bmatrix}u_c(1+k_1r_c^2+k_2r_c^4)\v_c(1+k_1r_c^2+k_2r_c^4)\end{bmatrix}=\begin{bmatrix}u_c’\v_c’\end{bmatrix}\xrightarrow[\text{相机模型}]{f_x, f_y, c_x, c_y}<br>\begin{bmatrix}f_xu_c’+c_x\f_yv_c’+c_y\end{bmatrix}=\begin{bmatrix}u_s\v_s\end{bmatrix}=\boldsymbol z<br>$$<br>这个过程也就是之前讲的<strong>观测方程</strong><br>$$<br>\boldsymbol z=h(\boldsymbol x, \boldsymbol y)<br>$$<br>这里的$\boldsymbol x$就是相机的位姿，具体可以表示为李群$\boldsymbol T$或者李代数$\boldsymbol \xi$。那么，相机$\boldsymbol \xi_i$观测到特征点$\boldsymbol p_j$的误差$\boldsymbol e_{ij}$就可以表示为<br>$$<br>\boldsymbol e_{ij}=\boldsymbol z_{ij}-h(\boldsymbol \xi_i, \boldsymbol p_j)<br>$$<br><strong>注意这里的$\boldsymbol e_{ij}$并不是一个数值，而是二维向量</strong></p><p>整体的代价函数为<br>$$<br>\frac 1 2 \sum_{i=1}^m\sum_{j=1}^n \boldsymbol ||\boldsymbol e_{ij}||^2<br>$$</p><blockquote><p>这个代价函数，看起来是个数值。但看了后面的我感觉把要优化的目标函数<strong>想成</strong>一个$2m×n$的矩阵比较合理。也就是类似这个样子<br>$$<br>\begin{bmatrix}e_{11_1} &amp;&amp; e_{12_1} &amp;&amp; …\<br>e_{11_2} &amp;&amp; e_{12_2} &amp;&amp; …\<br>e_{21_1} &amp;&amp; e_{22_1} &amp;&amp; …\<br>e_{21_2} &amp;&amp; e_{22_2} &amp;&amp; …\<br>… &amp;&amp; … &amp;&amp; …\end{bmatrix}<br>$$<br>或者这样的分块矩阵</p><p>$$<br>\begin{bmatrix}\boldsymbol e_{11} &amp;&amp; \boldsymbol e_{12} &amp;&amp; …\<br>\boldsymbol e_{21} &amp;&amp; \boldsymbol e_{22} &amp;&amp; …\<br>… &amp;&amp; … &amp;&amp; …\end{bmatrix}<br>$$<br>但是后面好像还会重新排列一下，<strong>写出来</strong>可能更像是这样<br>$$<br>\begin{bmatrix}\boldsymbol e_{11}&amp;\boldsymbol e_{12}&amp;…&amp;\boldsymbol e_{21}&amp;\boldsymbol e_{22}&amp;…\end{bmatrix}^T<br>$$<br>总而言之，这里的矩阵到底是几乘几的好像并不重要，理解清楚$\boldsymbol e_{ij}$就行</p></blockquote><h4><span id="ba的求解">BA的求解</span></h4><p>求解BA的过程其实是不断通过$\boldsymbol H\Delta\boldsymbol x=\boldsymbol g$（高斯牛顿法）求解$\Delta\boldsymbol x$。而在后端中，这里的$\boldsymbol x$包含了所有的相机位姿和路标点位置<br>$$<br>\boldsymbol x=[\boldsymbol \xi_1,…,\boldsymbol \xi_m,\boldsymbol p_1,…,\boldsymbol p_n]^T\<br>\boldsymbol x=[\boldsymbol x_c, \boldsymbol x_p]^T<br>$$<br>而雅可比矩阵也相应的分块为<br>$$<br>\boldsymbol J=\begin{bmatrix}\boldsymbol F\ \ \boldsymbol E\end{bmatrix}<br>$$<br>对应的$\boldsymbol H$矩阵为<br>$$<br>\boldsymbol H = \boldsymbol J^T\boldsymbol J=<br>\begin{bmatrix}\boldsymbol F^T\boldsymbol F &amp; \boldsymbol F^T\boldsymbol E\\boldsymbol E^T\boldsymbol F &amp; \boldsymbol E^T\boldsymbol E\end{bmatrix}<br>$$<br>要求解$\boldsymbol H\Delta\boldsymbol x=\boldsymbol g$就要对$\boldsymbol H$求逆，矩阵求逆是一个$O(n^3)$复杂的的操作。对于<strong>特征点数量上百个</strong>的视觉SLAM，这种方法之所以可行是因为$\boldsymbol H$的特殊结构，而这种特殊结构正与图优化的图模型对应。</p><h4><span id="稀疏性和边缘化">稀疏性和边缘化</span></h4><p>$\boldsymbol H$的特殊结构就在于它并不是一个稠密的矩阵，尤其是在特征点对应的雅可比分块中。</p><blockquote><p>其实在滤波器（例如FastSLAM）中也会利用这一点，由于空间点（作为随机变量）的分布与其他特征点的位置是无关的，所以在估计的时候并不会使用很大的EKF，而是对每个空间点单独使用一个EKF进行估计。</p></blockquote><p>考虑代价函数的其中一个$\boldsymbol e_{ij}$<br>$$<br>\boldsymbol J_{ij}(x)=(\boldsymbol 0_{2×6},…,\boldsymbol 0_{2×6},\frac {\boldsymbol e_{ij}} {\boldsymbol \xi_{i}},\boldsymbol 0_{2×6},…\boldsymbol 0_{2×3},…,\boldsymbol 0_{2×3},\frac {\boldsymbol e_{ij}} {\boldsymbol p_{j}},\boldsymbol 0_{2×3},…,\boldsymbol 0_{2×3})<br>$$<br>显然相机在$\boldsymbol \xi_{i}$观测$\boldsymbol p_{j}$产生的误差只与$\boldsymbol \xi_{i}$和$\boldsymbol p_{j}$有关，所以雅可比矩阵有很强的稀疏性。从而导致$\boldsymbol H$也有很强的稀疏性</p><p><img src="https://s2.loli.net/2021/12/19/yWLJ2tKg1m4qVnG.png" alt="图1"></p><p>最终的$\boldsymbol H$的非零区域如下图左侧所示</p><p><img src="https://s2.loli.net/2021/12/19/ghLIYDanKlBc48C.png" alt="图2"></p><p>与非零块与图模型中的边一一对应。</p><p>有了这种性质就可以将线性方程组$\boldsymbol H\Delta\boldsymbol x=\boldsymbol g$分块进行求解（详见书）</p><h4><span id="鲁棒核函数">鲁棒核函数</span></h4><p>相比于滤波器的没有异常检测机制问题，非线性优化可以将误差项中的二范数换成鲁棒的核函数。</p><h2><span id="问题">问题</span></h2><p>没什么问题，只是这章东西太多了很多地方理解的还不够深入。</p><h2><span id="计划">计划</span></h2><p>跑一下后端BA的代码。</p><p>学习《视觉SLAM十四讲》第十章。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2&gt;&lt;span id=&quot;进展&quot;&gt;进展&lt;/span&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;第十五周主要完成了对《视觉SLAM十四讲》中第九讲——后端1的学习。内容包括以EKF为代表的滤波器后端和非线性优化后端。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这一章的理论非常多</summary>
      
    
    
    
    
    <category term="Notes" scheme="http://keep-a.live/tags/Notes/"/>
    
    <category term="SLAM" scheme="http://keep-a.live/tags/SLAM/"/>
    
    <category term="视觉SLAM十四讲" scheme="http://keep-a.live/tags/%E8%A7%86%E8%A7%89SLAM%E5%8D%81%E5%9B%9B%E8%AE%B2/"/>
    
    <category term="graduation project" scheme="http://keep-a.live/tags/graduation-project/"/>
    
  </entry>
  
  <entry>
    <title>A bug in FIFA 22</title>
    <link href="http://keep-a.live/2021/12/18/A-bug-in-FIFA-22/"/>
    <id>http://keep-a.live/2021/12/18/A-bug-in-FIFA-22/</id>
    <published>2021-12-18T14:43:24.000Z</published>
    <updated>2021-12-18T14:45:46.725Z</updated>
    
    <content type="html"><![CDATA[<p>Ter Stegen has superpowers!</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Ter Stegen has superpowers!&lt;/p&gt;
</summary>
      
    
    
    
    <category term="gallery" scheme="http://keep-a.live/categories/gallery/"/>
    
    
    <category term="football" scheme="http://keep-a.live/tags/football/"/>
    
    <category term="FIFA22" scheme="http://keep-a.live/tags/FIFA22/"/>
    
    <category term="video games" scheme="http://keep-a.live/tags/video-games/"/>
    
  </entry>
  
  <entry>
    <title>Progress Report 6</title>
    <link href="http://keep-a.live/2021/12/12/Progress-Report-6/"/>
    <id>http://keep-a.live/2021/12/12/Progress-Report-6/</id>
    <published>2021-12-12T06:51:51.000Z</published>
    <updated>2021-12-13T03:25:02.933Z</updated>
    
    <content type="html"><![CDATA[<p><em>公式渲染的可能会比较慢</em></p><blockquote><p>在我的博客中你将会看到三种正经的东西：<a href="/tags/Tutorials">Tutorials</a>、<a href="/tags/Notes">Notes</a>和<a href="/tags/Projects">Projects</a></p><p><a href="/tags/Tutorials">Tutorials</a>会写的比较详细。一般是我在写代码中产生的，用于记录一些我会的东西，也可以当作<strong>教学</strong>来看</p><p><a href="/tags/Notes">Notes</a>是一些学习中的笔记，更多的记录一些我<strong>自己的理解</strong>，希望大家在评论区指正和讨论</p><p><a href="/tags/Projects">Projects</a>将会<strong>分享一些我做的东西</strong></p></blockquote><h1><span id="毕业实训进度报告6">毕业实训进度报告6</span></h1><h2><span id="进展">进展</span></h2><blockquote><p>第十四周主要完成了对《视觉SLAM十四讲》中第八讲——视觉里程计2的学习。内容主要包括视觉里程计中的<strong>光流法</strong>和<strong>直接法</strong>。</p></blockquote><p>关键点法的主要问题：</p><ul><li>计算特征点的时间长</li><li>忽略了除特征点以外的信息</li><li>在没有明显纹理信息时（如面对一面白墙）效果差</li></ul><h3><span id="光流法">光流法</span></h3><p>计算特征点（仅第一帧）→使用光流追踪特征点→对极几何/PnP/ICP</p><h4><span id="lucas-kanada光流稀疏光流的代表">Lucas-Kanada光流（稀疏光流的代表）</span></h4><p>将图像看成时间的函数： $\boldsymbol{I}(t)$ ， $t$ 时刻，位于 $(x,y)$ 点的灰度表示为<br>$$<br>\boldsymbol{I}(x,y,t)<br>$$<br><strong>灰度不变假设：</strong> 同一空间点的灰度值，在各个图像中是固定不变的。<br>$$<br>\boldsymbol{I}(x+\mathrm{d} x,y+\mathrm{d}y,t+\mathrm{d}t)=\boldsymbol{I}(x,y,t)<br>$$</p><p>泰勒展开<br>$$<br>\boldsymbol{I}(x+\mathrm{d} x,y+\mathrm{d}y,t+\mathrm{d}t)\approx \boldsymbol{I}(x,y,t) + \frac{\partial\boldsymbol{I}} {\partial x}\mathrm{d}x+ \frac{\partial\boldsymbol{I}} {\partial y}\mathrm{d}y+ \frac{\partial\boldsymbol{I}} {\partial t}\mathrm{d}t<br>$$<br>化简得<br>$$<br>\frac{\partial\boldsymbol{I}} {\partial x}\frac{\mathrm{d}x} {\mathrm{d}t}+ \frac{\partial\boldsymbol{I}} {\partial y}\frac{\mathrm{d}y} {\mathrm{d}t}=-\frac{\partial\boldsymbol{I}} {\partial t}<br>$$<br>💡<strong>这里我的理解是</strong>：灰度的变化是由图像本身的梯度 $\frac{\partial\boldsymbol{I}} {\partial x}$ 和像素的运动 $\frac{\mathrm{d}x} {\mathrm{d}t}$ 线性组合而成的。于是已知灰度的变化和图像的梯度就可以推出像素的运动，从而达到追踪特征点的目的。</p><p>但是像素的运动（在相机的成像中）是二维的，没法只通过一个方程解出来。于是LK光流假设：某一个窗口（特征点周围的一个小范围）内的像素具有相同的运动，这样就有了更多的约束，形成了一个超定方程，用最小二乘求解。</p><p>实际上是要找到$\mathrm{d}x,\mathrm{d}y$使得$\boldsymbol{I}$的变化最小，而优化过程中的Jacobian就是图像在目标点处的梯度</p><p><strong>多层光流：<strong>所拍摄的图像不那么连续的时候，<strong>泰勒展开</strong>就会失效，导致光流追踪的效果很差。所以使用图像金字塔进行多层光流，<strong>由粗至精</strong>的进行求解，具体来说就是使用</strong>上一层计算所得的运动</strong>对下一层的计算进行<strong>初始化</strong>。</p><h3><span id="直接法">直接法</span></h3><p>同样也假设<strong>灰度不变</strong>，与光流法的区别在于<strong>同时追踪特征点和计算相机的运动</strong>，以确保全局最优。或者说，<strong>直接通过灰度的变化推出相机的运动</strong>。（💡但这一方法需要<strong>深度信息</strong>，这可以通过RGB-D相机直接得到，对单目相机只能通过三角测量得出，这就意味着只能用在初始化完成之后。或者同时把深度也作为优化目标，这就更加复杂了。）</p><p>灰度变化的产生原因：**相机运动 $\boldsymbol T$， 导致空间点 $P$ 在像素坐标系中运动 $p_1→p_2$ 。 **而估计的运动$\boldsymbol T$使得空间点$P$在像素坐标中运动$p_1→p_2’$，导致真实的$p_2$与估计的$p_2’$灰度$e$不同，按照这个思路就可以求出$\frac{\partial e} {\partial \boldsymbol{T}}$（推导详见书上）<br>$$<br>\frac{\partial e} {\partial \boldsymbol{T}} = \frac{\partial \boldsymbol{I}_2} {\partial \boldsymbol{u}} \frac{\partial \boldsymbol{u}} {\partial \boldsymbol{q}}\frac{\partial \boldsymbol{q}} {\partial \delta\boldsymbol{\xi}}\delta\boldsymbol{\xi}<br>$$<br>其中$\frac{\partial \boldsymbol{I}_2} {\partial \boldsymbol{u}}$为$\boldsymbol{u}$处图像梯度，$\frac{\partial \boldsymbol{u}} {\partial \boldsymbol{q}}$为二维点（像素坐标）对三维点（相机坐标）的导数，$\frac{\partial \boldsymbol{q}} {\partial \delta\boldsymbol{\xi}}$为三维点对运动的导数，$\delta\boldsymbol{\xi}$为运动的左扰动。反过来说就是，运动引起空间点在相机坐标系运动，引起空间点在像素坐标运动，再结合图像本身的梯度。这三者导致了灰度的变化。</p><p>接下来只需要初始化一个相机运动再进行进行非线性优化就行了。</p><p>举一个例子：假设初始化的运动是<em>原地不动</em>，但是空间点P对应的像素却变亮了。于是就需要模拟出一个运动，使得<strong>更亮的点</strong>对上空间点P。</p><p>这样一想就可以很容易的理解书上直接法的缺点了。</p><h2><span id="问题">问题</span></h2><p>对自动曝光的相机可否先<strong>利用相机的曝光参数对图像进行预处理</strong>，再做以上两种方法，使其更好的满足灰度不变假设呢？</p><h2><span id="计划">计划</span></h2><ol><li>学习《视觉SLAM十四讲》第九章</li><li>继续阅读ORBSLAM代码（&amp;论文，如果有时间）</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;公式渲染的可能会比较慢&lt;/em&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;在我的博客中你将会看到三种正经的东西：&lt;a href=&quot;/tags/Tutorials&quot;&gt;Tutorials&lt;/a&gt;、&lt;a href=&quot;/tags/Notes&quot;&gt;Notes&lt;/a&gt;和&lt;a hr</summary>
      
    
    
    
    
    <category term="Notes" scheme="http://keep-a.live/tags/Notes/"/>
    
    <category term="SLAM" scheme="http://keep-a.live/tags/SLAM/"/>
    
    <category term="视觉SLAM十四讲" scheme="http://keep-a.live/tags/%E8%A7%86%E8%A7%89SLAM%E5%8D%81%E5%9B%9B%E8%AE%B2/"/>
    
    <category term="graduation project" scheme="http://keep-a.live/tags/graduation-project/"/>
    
  </entry>
  
  <entry>
    <title>ZYZ at work</title>
    <link href="http://keep-a.live/2021/12/10/ZYZ%20at%20work/"/>
    <id>http://keep-a.live/2021/12/10/ZYZ%20at%20work/</id>
    <published>2021-12-10T08:25:59.000Z</published>
    <updated>2021-12-10T12:47:21.578Z</updated>
    
    <content type="html"><![CDATA[<p>This photo captures an angry woman😠.</p><h2><span id="information">📷Information</span></h2><table><thead><tr><th style="text-align:center">参数</th><th style="text-align:center">数值</th></tr></thead><tbody><tr><td style="text-align:center">光圈系数</td><td style="text-align:center">1.8</td></tr><tr><td style="text-align:center">焦距</td><td style="text-align:center">50</td></tr><tr><td style="text-align:center">照相感光度(ISO)</td><td style="text-align:center">320</td></tr><tr><td style="text-align:center">镜头型号</td><td style="text-align:center">LUMIX S 50/F1.8</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;This photo captures an angry woman😠.&lt;/p&gt;
&lt;h2&gt;&lt;span id=&quot;information&quot;&gt;📷Information&lt;/span&gt;&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align</summary>
      
    
    
    
    <category term="gallery" scheme="http://keep-a.live/categories/gallery/"/>
    
    
    <category term="zyz" scheme="http://keep-a.live/tags/zyz/"/>
    
    <category term="life" scheme="http://keep-a.live/tags/life/"/>
    
    <category term="photography" scheme="http://keep-a.live/tags/photography/"/>
    
  </entry>
  
  <entry>
    <title>Interesting things in this website</title>
    <link href="http://keep-a.live/2021/12/09/Interesting-things/"/>
    <id>http://keep-a.live/2021/12/09/Interesting-things/</id>
    <published>2021-12-09T12:43:55.000Z</published>
    <updated>2021-12-10T13:26:59.932Z</updated>
    
    <content type="html"><![CDATA[<p>这两天刚刚搭起来这个博客，分享一些在写网站过程中有趣的地方。</p><h2><span id="域名">🔗域名</span></h2><p>域名是我在<a href="https://sg.godaddy.com">Godaddy</a>上买的，服务器甚至都没买，就是借住在<a href="https://github.com/Li-Jesse-Jiaze/Li-Jesse-Jiaze.github.io">Github</a>上。主要是因为买国内的服务器还要备案什么的。</p><p>这样总共15块钱一年还算挺便宜的。关于为什么叫域名<code>keep-a.live</code>可以去看<a href="/about/">About</a>或者<a href="/">首页</a>。</p><h2><span id="️javascript">☕️JavaScript</span></h2><p>今天（2021年12月9日）可以说是我自己写<code>JavaScript</code>的第三天，这还是算上之前帮别人debug的日子。可以说是纯纯的新手。对于新手而言，我觉得网页好不好看，主要是看有没有找到好的模版，其次也有点需要审美。但对我自己的博客而言，更想做到<strong>有趣</strong>，而非仅仅好看。而这就有点像是在<strong>收藏</strong><code>JavaScript</code>，并且把它们都摆在这个网站上展示出来。</p><h3><span id="页脚">🦶页脚</span></h3><p>页脚的有个很像命令行的东西</p><p>jesse@keep-alive:~/2021/12/09/Interesting-things/$ mkdir /cool/code</p><p>有两点有意思的地方</p><ol><li><h4><span id="后面这个命令mkdir-coolcode有类似在打字一样的动画">后面这个命令mkdir /cool/code，有类似在打字一样的动画</span></h4></li></ol><p>这里用了<a href="https://www.cssscript.com/demo/simple-typewriter-effect-pure-javascript-typewriterjs/">这个</a>，直接移植。这里简单记录一下怎么移植。</p><p>​Step1: 把<code>js</code>文件放到<code>source</code>文件夹里。其实不管是你自己的<code>source</code>文件夹还是主题的都可以，可以想象成他们之后会合并成一个文件夹。</p><p>​Step2: 在需要这个js的<code>/layout/footer.ejs</code>里加上一行</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/js/typewriter.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果是放在页脚这种会出现在很多页面中的地方，一定要用<strong>绝对路径</strong></p><p>​Step3: 在<code>/layout/footer.ejs</code>中调用即可</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> pathname = <span class="built_in">window</span>.location.pathname;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">&#x27;pathname&#x27;</span>).innerText = pathname;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> btapp = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;btapp&#x27;</span>);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> bttypewriter = <span class="keyword">new</span> Typewriter(btapp, &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">loop</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="javascript">    &#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    bttypewriter.typeString(<span class="string">&#x27;mkdir /cool/code&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        .pauseFor(<span class="number">800</span>)</span></span><br><span class="line"><span class="javascript">        .deleteChars(<span class="number">4</span>)</span></span><br><span class="line"><span class="javascript">        .typeString(<span class="string">&#x27;life&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        .pauseFor(<span class="number">800</span>)</span></span><br><span class="line"><span class="javascript">        .deleteAll()</span></span><br><span class="line"><span class="javascript">        .typeString(<span class="string">&#x27;have fun&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        .pauseFor(<span class="number">800</span>)</span></span><br><span class="line"><span class="javascript">        .start();</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li><h4><span id="前面这个路径~20211209in也是在网站中当前网页的路径可以跳转到别的页面试试">前面这个路径~/2021/12/09/In…，也是在网站中当前网页的路径（可以跳转到别的页面试试）</span></h4></li></ol><p>这个实现起来很简单，以下是<code>.ejs</code>代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jesse@keep-alive:~<span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;pathname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>$</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> pathname = <span class="built_in">window</span>.location.pathname;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">&#x27;pathname&#x27;</span>).innerText = pathname;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这个博客用的是Hexo的框架，他具体是怎么生成的我还不是很清楚，不过只要把这个添加到你的主题文件夹里的<code>.ejs</code>，就可以咯。</p><h3><span id="️404">❗️404</span></h3><p>你可以尝试一下访问这个网站的<a href="/404">404页面</a>，也会很有意思的。是我之前看了-LKs-的视频，他推荐了个<a href="https://theuselessweb.com">网站</a>，这个网站里面的一个作品</p><h2><span id="接下来要做的事">🔭接下来要做的事</span></h2><p>还有很多要做的东西，比如说<code>robot.txt</code>还没写，虽然说还没写这个就写404页面挺离谱的。还有会慢慢加上更多内容，换个主题什么的。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;这两天刚刚搭起来这个博客，分享一些在写网站过程中有趣的地方。&lt;/p&gt;
&lt;h2&gt;&lt;span id=&quot;域名&quot;&gt;🔗域名&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;域名是我在&lt;a href=&quot;https://sg.godaddy.com&quot;&gt;Godaddy&lt;/a&gt;上买的，服务器甚至都没买，就是</summary>
      
    
    
    
    
    <category term="theme" scheme="http://keep-a.live/tags/theme/"/>
    
    <category term="css" scheme="http://keep-a.live/tags/css/"/>
    
    <category term="JavaScript" scheme="http://keep-a.live/tags/JavaScript/"/>
    
    <category term="website" scheme="http://keep-a.live/tags/website/"/>
    
  </entry>
  
  <entry>
    <title>Wheatfield with Crows - one of my favorite paintings</title>
    <link href="http://keep-a.live/2021/12/07/Wheatfield-with-Crows-my-favorite-painting/"/>
    <id>http://keep-a.live/2021/12/07/Wheatfield-with-Crows-my-favorite-painting/</id>
    <published>2021-12-07T12:22:20.000Z</published>
    <updated>2021-12-08T02:05:06.809Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><em><strong>Wheatfield with Crows</strong></em> is a July 1890 painting by <a href="https://en.wikipedia.org/wiki/Vincent_van_Gogh">Vincent van Gogh</a>. It has been cited by several critics as one of his greatest works.</p></blockquote><p>Aesthetically I prefer Van Gogh’s last self-portrait. But after seeing <em>Loving Vincent</em>, the storytelling of this painting appealed to me even more. In the play, the sound of Van Gogh’s suicidal gunshot startles away crows in the wheat field. It was for the plot. But this being Van Gogh’s last painting, it still touches me every time I see it.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Wheatfield with Crows&lt;/strong&gt;&lt;/em&gt; is a July 1890 painting by &lt;a href=&quot;https://en.wikipedia.org/wiki/Vincent_va</summary>
      
    
    
    
    <category term="gallery" scheme="http://keep-a.live/categories/gallery/"/>
    
    
    <category term="painting" scheme="http://keep-a.live/tags/painting/"/>
    
    <category term="Vincent" scheme="http://keep-a.live/tags/Vincent/"/>
    
    <category term="van Gogh" scheme="http://keep-a.live/tags/van-Gogh/"/>
    
  </entry>
  
  <entry>
    <title>Liwenjian Typora theme</title>
    <link href="http://keep-a.live/2021/12/07/Liwenjian-Typora-theme/"/>
    <id>http://keep-a.live/2021/12/07/Liwenjian-Typora-theme/</id>
    <published>2021-12-07T03:09:24.000Z</published>
    <updated>2021-12-12T08:23:37.287Z</updated>
    
    <content type="html"><![CDATA[<p>I wrote a Typora theme. The project has been released to <a href="https://github.com/Li-Jesse-Jiaze/Liwenjian-Typora-Theme">my Github</a>. Feel free to use it.</p><h2><span id="install">🔨Install</span></h2><ol><li>Download <a href="https://github.com/Li-Jesse-Jiaze/Liwenjian-Typora-Theme/releases/tag/0.1.0">this</a> zip from Github, extract this file, then you can get the <code>lwj-dark.css</code>,  <code>lwj-light.css</code>  and   <code>liwenjian</code> folder.</li><li>Open typora, click <code>Preference</code> → <code>Apperance</code> → <code>Open Theme Folder </code>.</li><li>Put <code>lwj-dark.css</code>,  <code>lwj-light.css</code>  and   <code>liwenjian</code> folder into the open folder.</li><li>Close Typora totally, reopen Typora and select <code>Theme</code> → <code>lwj-light</code> from the menu bar.</li></ol><h2><span id="️notes">⚠️Notes</span></h2><ul><li>Designed and tested on macOS. Not fully tested, but should work for Windows/Linux.</li><li>It is better to install <code>Operator Mono</code> font by yourself first.</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;I wrote a Typora theme. The project has been released to &lt;a href=&quot;https://github.com/Li-Jesse-Jiaze/Liwenjian-Typora-Theme&quot;&gt;my Github&lt;/a&gt;</summary>
      
    
    
    
    <category term="gallery" scheme="http://keep-a.live/categories/gallery/"/>
    
    
    <category term="theme" scheme="http://keep-a.live/tags/theme/"/>
    
    <category term="css" scheme="http://keep-a.live/tags/css/"/>
    
    <category term="markdown" scheme="http://keep-a.live/tags/markdown/"/>
    
    <category term="Typora" scheme="http://keep-a.live/tags/Typora/"/>
    
    <category term="Projects" scheme="http://keep-a.live/tags/Projects/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://keep-a.live/2021/12/07/hello-world/"/>
    <id>http://keep-a.live/2021/12/07/hello-world/</id>
    <published>2021-12-06T16:21:57.657Z</published>
    <updated>2021-12-07T13:06:59.244Z</updated>
    
    <content type="html"><![CDATA[<p>This is my first blog post. For testing.</p><h3><span id="code-test">code test</span></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//Your first C++ code</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;This is my first blog post. For testing.&lt;/p&gt;
&lt;h3&gt;&lt;span id=&quot;code-test&quot;&gt;code test&lt;/span&gt;&lt;/h3&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td </summary>
      
    
    
    
    <category term="gallery" scheme="http://keep-a.live/categories/gallery/"/>
    
    
    <category term="Hello World" scheme="http://keep-a.live/tags/Hello-World/"/>
    
  </entry>
  
</feed>
